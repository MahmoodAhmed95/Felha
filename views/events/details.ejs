<%- include('../partials/navbar.ejs') %>

  <body>
    <h1 class="titleOne" id="eventTitleDetail">
      <%=`${event.name}`%> Details
    </h1>
    <div class="details">
      <div class="container">
        <div class="head-info">
          <div class="image">
            <img src="<%= event.profile_img %>" alt="">
          </div>
          <div class="informations">
            <div class="name">
              <h3>
                <%=`${event.name}`%>
              </h3>
            </div>
            <div class="description">
              <p>
                <%=`${event.description}`%>
              </p>
            </div>
            <div class="contact-cost">
              <span><i class="bi bi-telephone"></i><b>Contact:</b> <span>
                  <%=`${event.contact}`%>
                </span></span>
              <span><i class="bi bi-cash-stack"></i>Cost: <span>
                  <%=`${event.cost}`%>
                </span> BD</span>
            </div>
            <div class="dates">
              <span><i class="bi bi-calendar4-week"></i>Start Date: <span>
                  <%=`${event.startDate}`%>
                </span></span>
              <span class="mid"><i class="bi bi-calendar4-week"></i>End Date: <span>
                  <%=`${event.endDate}`%>
                </span></span>
              <span><i class="bi bi-hourglass-split"></i>Time Duration: <span>
                  <%=`${event.timeDuration}`%>
                </span> Hours</span>
            </div>
          </div>
        </div>
        <div class="location-info">
          <div class="location">
            <%-`${event.location}`%>
          </div>
        </div>
        <div class="add-review">


          <h2>Add a Review</h2>


          <% if (user) { %>

            <form action="/events/<%= event._id %>/reviews" method="POST">
              <div class="rating-starz mb-3">
                <span>Rating:</span>
                <div class="stars">
                  <input type="radio" id="star1" name="rating" value="1" />
                  <label for="star1" title="1 stars"><i class="bi bi-star-fill"></i></label>
                  <input type="radio" id="star2" name="rating" value="2" />
                  <label for="star2" title="2 stars"><i class="bi bi-star-fill"></i></label>
                  <input type="radio" id="star3" name="rating" value="3" />
                  <label for="star3" title="3 stars"><i class="bi bi-star-fill"></i></label>
                  <input type="radio" id="star4" name="rating" value="4" />
                  <label for="star4" title="4 stars"><i class="bi bi-star-fill"></i></label>
                  <input type="radio" id="star5" name="rating" value="5" />
                  <label for="star5" title="5 stars"><i class="bi bi-star-fill"></i></label>
                </div>
              </div>
              <div class="form-floating mb-3 txetarea-div">
                <textarea name="content" class="form-control" id="newEveDesc"></textarea>
                <label for="newEveDesc">How was your Experience?</label>
              </div>
              <input type="submit" class="btn btn-primary" value="Add Review">

              <% } else { %>

                <div class="signInHolder">
                  <a href="/auth/google">
                    <button type="button" id="signIntoReview" class="btn btn-primary">Login to Add Review!</button>

                  </a>
                </div>




            </form>
            <% } %>


        </div>







        <div class="reviews">
          <% event.reviews.forEach(function(r) { %>

            <div class="review">

              <div class="image-holder">

                <div class="image">
                  <img alt="avatar" src="<%= r.userAvatar %>" referrerpolicy="no-referrer">
                </div>
              </div>
              <div class="text">
                <h2>
                  <%= r.userName %>
                </h2>
                <p>
                  <%= r.content %>
                </p>


                <!-- STYLE THE DATE -->
                <%= r.createdAt.toLocaleDateString() %>

                  <!-- STYLE THE rating -->

                  <%= r.rating%>


              </div>





              <div class="rating"></div>
              <div class="control">
                <button><i class="bi bi-pencil"></i> Edit</button>
                <button><i class="bi bi-trash3"></i> Delete</button>
              </div>

            </div>
            <% }); %>
        </div>
      </div>
    </div>
    <!-- Bootstrap Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"></script>
    <!-- our scripts -->
    <script src="js/starz.js"></script>













    <!--             
              <table>
                <thead>
                  <tr>
                    <th>User</th>
                    <th>Date</th>
                    <th>Review</th>
                    <th>Rating</th>
                  </tr>
                </thead> -->
    <!-- <tbody>



                  <% let total=0 %> 
                    <% event.reviews.forEach(function(r) { %>
                      <% total +=r.rating %> 

                        <tr>
                          <td class="review-user"><img alt="avatar" src="<%= r.userAvatar %>"
                              referrerpolicy="no-referrer">
                            <%= r.userName %>
                          </td>
                          <td>
                            <%= r.createdAt.toLocaleDateString() %>
                          </td>
                          <td>
                            <%= r.content %>
                          </td>
                          <td>
                            <%= r.rating%>
                          </td>
                        </tr>
                        <% }); %>
                          <tr>
                            <td colspan="3"></td> 


                         <td><strong>
                                <%= (total / event.reviews.length).toFixed(1)=="NaN" ? "" :(total /
                                  event.reviews.length).toFixed(1) %>
                              </strong></td> 
                          </tr>
                </tbody> -->


    </table>










  </body>

  </html>